"describe" {
  % Store all tests in one dictionary
  {
    % Check if it exists
    _allTests
  }
  {
    dup "name" get "Undefined" eq
    {
      pop "_allTests" dict def
    }
    {
      throw
    }
    ifelse
  }
  catch

  dict begin % stack a context dictionary

  "check_name_and_block" {
    dup type "blocktype" neq { typecheck } if
    1 index type "stringtype" neq { typecheck } if
  } bind def

  "it" {
    check_name_and_block

    dict
      "type" "it" set
      "name" 4 -1 roll set
      "block" 3 -1 roll set
      
    content exch apush

  } bind def

  {
    check_name_and_block

    dict begin % stack describe dictionary
    {
      "type" "describe" def
      "name" 3 -1 roll def
      "content" [] def

      true exch if % execute block
    }
    {
      end % unstack describe dictionary
    }
    finally

    currentdict

  } bind
  {
    end % unstack context dictionary
  } finally

} bind def

"run_all_tests" {

} bind def